(function(e,t){var n;n=function(){function t(t,n){var r,i,s,o,u;this.el=t;this.args=n;this.args=e.extend(this.defaults,this.args);this.$el=e(t);this.container=this.CreateContainer();this.opts=this.PrepareOpts(e("option",this.el));e(".selectr-list-group",this.container).append(this.opts);i=0;u=this.opts;for(s=0,o=u.length;s<o;s++){r=u[s];if(r.hasClass("selectr-selected")){i++}}e(".selectr-current-selection",this.container).text(i);this.MonitorSource();this.container.insertAfter(this.el);this.$el.hide()}t.prototype.defaults={Selectr:t,title:"",placeholder:"Search",resetText:"Clear All",width:"300px",maxListHeight:"250px"};t.prototype.CreateContainer=function(){return e(document.createElement("div")).attr({"class":"selectr selectr-container panel panel-default",style:"width: "+this.args.width+";"}).html("<div class='selectr-panel-heading panel-heading "+(this.args.title===""?"no-title":void 0)+"'>\n  <h4 class='selectr-panel-title panel-title'>\n    "+this.args.title+"\n  </h4>\n</div>\n<div class='selectr-panel-body panel-body'>\n  <input class='selectr-form-control form-control' placeholder='"+this.args.placeholder+"'>\n</div>\n<ul class='selectr-list-group list-group' style='max-height: "+this.args.maxListHeight+"'>\n</ul>\n<div class='selectr-panel-footer panel-footer'>\n  <button class='selectr-reset btn btn-sm btn-default'>\n    "+this.args.resetText+"\n  </button>\n  "+(this.$el.prop("multiple")?"<span class='selectr-current-selection pull-right badge'></span>":void 0)+"\n</div>")};t.prototype.PrepareOpts=function(t){var n,r,i,s;s=[];for(r=0,i=t.length;r<i;r++){n=t[r];s.push(e(document.createElement("li")).attr({"class":"selectr-list-group-item list-group-item "+(n.selected?"selectr-selected":"")}).text(e(n).text()).data("val",e(n).val()).append(e(document.createElement("span")).html("&times").attr({"class":"selectr-pull-right selectr-add-remove pull-right "+(!this.$el.prop("multiple")?"hidden":void 0)})))}return s};t.prototype.MonitorSource=function(){var t;t=this;return this.$el.on("change",function(n){var r,i;if(!e(n.target).data("selectr-change-triggered")){i=e(document.createElement("ul")).attr({"class":"selectr-list-group list-group",style:"max-height: "+t.args.maxListHeight+";"});r=t.PrepareOpts(e("option",this));i.append(r);return e(".selectr-list-group",e(this).next()).replaceWith(i)}})};t.TriggerChange=function(e){e.data("selectr-change-triggered",true);e.trigger({type:"change"});return e.data("selectr-change-triggered",false)};t.SelectOption=function(t,n){var r,i,s,o,u,a;i=e(n).parents(".selectr-container").prev();if(!t){e("option",i).prop("selected",false);a=e(n).siblings();for(o=0,u=a.length;o<u;o++){s=a[o];e(s).removeClass("selectr-selected")}}e(n).addClass("selectr-selected");e("option[value="+e(n).data("val")+"]",i).prop("selected",true);r=e("option:selected",i).length;e(".selectr-current-selection",e(n).parents(".selectr-container")).text(r>0?r:"");return this.TriggerChange(e(n).parents(".selectr-container").prev())};t.DeselectOption=function(t){var n,r;r=e(t).parents(".selectr-container").prev();e(t).removeClass("selectr-selected");e("option[value="+e(t).data("val")+"]",r).prop("selected",false);n=e("option:selected",r).length;return e(".selectr-current-selection",e(t).parents(".selectr-container")).text(n>0?n:"")};t.InstallBindings=function(){e(document).on("click",".selectr-list-group-item",function(n){var r;r=n.ctrlKey&&e(this).parents(".selectr-container").prev().prop("multiple");if(e(this).hasClass("selectr-selected")&&(r||e(this).siblings(".selectr-selected").length===0)){t.DeselectOption(this)}else{t.SelectOption(r,this)}n.stopPropagation();return n.preventDefault()});e(document).on("click",".selectr-add-remove",function(n){var r;r=e(n.target).parents(".selectr-list-group-item");if(r.hasClass("selectr-selected")){t.DeselectOption(r)}else{t.SelectOption(true,r)}n.stopPropagation();return n.preventDefault()});e(document).on("change keyup",".selectr-form-control",function(t){var n;n=new RegExp(e(this).val().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"i");e(this).parents(".selectr-container").find("ul > li").each(function(t,r){if(!e(r).text().match(n)){return e(r).addClass("hidden")}else{return e(r).removeClass("hidden")}});t.stopPropagation();return t.preventDefault()});return e(document).on("click",".selectr-reset",function(n){var r;r=e(this).parents(".selectr-container").prev();e(this).parents(".selectr-container").find("ul > li").removeClass("selectr-selected");e("option",r).prop("selected",false);t.TriggerChange(r);e(".selectr-current-selection",e(this).parents(".selectr-container")).text("");n.stopPropagation();return n.preventDefault()})};return t}();return e.fn.extend({selectr:function(t){this.each(function(){var r,i;r=e(this);i=r.data("selectr");if(!i){return r.data("selectr",i=new n(this,t))}});return n.InstallBindings()}})})($,window)