#!/usr/bin/env node
// Generated by CoffeeScript 1.6.3
var argv, coffee, errors, hintFiles, other, splitArgs, _, _ref;

_ = require("underscore");

hintFiles = require("./lib-js/hint");

argv = require("optimist").options({
  'options': {
    alias: 'o',
    describe: 'comma separated list of JSHint options to turn on'
  },
  'defaults-options-off': {
    type: 'boolean',
    describe: 'turns off default options'
  },
  'globals': {
    alias: 'g',
    describe: 'comma separated list of global variable names to permit'
  }
}).argv;

splitArgs = function(strList) {
  var _ref;
  return (_ref = strList != null ? strList.split(',') : void 0) != null ? _ref : [];
};

_ref = _(argv._).groupBy(function(path) {
  if (/.+\.coffee$/.test(path)) {
    return "coffee";
  } else {
    return "other";
  }
}), coffee = _ref.coffee, other = _ref.other;

if ((other != null ? other.length : void 0) > 0) {
  console.log("Skipping files that don't end in .coffee:\n" + other.join('\n'));
}

errors = hintFiles(coffee, {
  options: splitArgs(argv.options),
  withDefaults: !argv['default-options-off'],
  globals: splitArgs(argv.globals)
}, true);

if (_.flatten(errors).length === 0) {
  process.exit(0);
} else {
  process.exit(1);
}
